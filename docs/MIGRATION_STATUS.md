# ‚úÖ –°–¢–ê–¢–£–° –ú–ò–ì–†–ê–¶–ò–ò –ù–ê DISCOVERY ENGINE API

**–î–∞—Ç–∞:** 2026-01-27  
**–°—Ç–∞—Ç—É—Å:** –í –ø—Ä–æ—Ü–µ—Å—Å–µ

---

## ‚úÖ –ß–¢–û –£–ñ–ï –°–î–ï–õ–ê–ù–û

### 1. **–ü—Ä–∞–≤–∞ Service Account** ‚úÖ
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–æ–ª—å `roles/discoveryengine.viewer` –¥–ª—è Service Account
- ‚úÖ –ö–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞:
  ```bash
  gcloud projects add-iam-policy-binding gen-lang-client-0102901194 \
    --member="serviceAccount:ai-citi-assistant@gen-lang-client-0102901194.iam.gserviceaccount.com" \
    --role="roles/discoveryengine.viewer"
  ```

### 2. **Discovery Engine API** ‚úÖ
- ‚úÖ API –≤–∫–ª—é—á–µ–Ω (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤ –∫–æ–Ω—Å–æ–ª–∏)
- ‚úÖ –ï—Å—Ç—å —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ "Vertex AI Search: Advance Generative Answers" (THB 316.34)
- ‚úÖ –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ API —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è!

### 3. **–ö–æ–¥** ‚úÖ
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `searchRAG()` —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ `supabase/functions/gemini-chat/index.ts`
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ `useRAG` –∏ `ragDataStoreId`
- ‚úÖ –ì–∏–±—Ä–∏–¥–Ω—ã–π —Ä–µ–∂–∏–º (RAG + Gemini) —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω

### 4. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** ‚úÖ
- ‚úÖ –°–æ–∑–¥–∞–Ω –ø–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏: `/docs/DISCOVERY_ENGINE_MIGRATION_PLAN.md`
- ‚úÖ –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è Data Store: `/scripts/create-data-store.py`

---

## ‚è≥ –ß–¢–û –û–°–¢–ê–õ–û–°–¨ –°–î–ï–õ–ê–¢–¨

### **–ó–ê–î–ê–ß–ê: –°–æ–∑–¥–∞—Ç—å Data Store**

**–ü–æ—á–µ–º—É —ç—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤—Ä—É—á–Ω—É—é:**
- –°–æ–∑–¥–∞–Ω–∏–µ Data Store —Ç—Ä–µ–±—É–µ—Ç –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö (Website/PDF/Cloud Storage)
- –ù—É–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏–ª–∏ —É–∫–∞–∑–∞—Ç—å URL
- –≠—Ç–æ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –∫–æ—Ç–æ—Ä—ã–π —Å–ª–æ–∂–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å

**–ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å:**

1. **–û—Ç–∫—Ä—ã—Ç—å –∫–æ–Ω—Å–æ–ª—å:**
   ```
   https://console.cloud.google.com/gen-app-builder/data-stores/create?project=gen-lang-client-0102901194
   ```

2. **–ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É:**
   - **Display name:** `test-rag-store` (–∏–ª–∏ –ª—é–±–æ–µ –∏–º—è)
   - **Data store type:** –í—ã–±—Ä–∞—Ç—å –æ–¥–∏–Ω –∏–∑:
     - **Website** - –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –≤–µ–±-—Å–∞–π—Ç–∞
     - **Cloud Storage** - –¥–ª—è —Ñ–∞–π–ª–æ–≤ –≤ GCS
     - **Unstructured** - –¥–ª—è PDF/—Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
   - **Location:** `global` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)

3. **–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ:**
   - **–í–∞—Ä–∏–∞–Ω—Ç –ê:** –£–∫–∞–∑–∞—Ç—å URL –≤–µ–±-—Å–∞–π—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Whitepaper AR Arena)
   - **–í–∞—Ä–∏–∞–Ω—Ç –ë:** –ó–∞–≥—Ä—É–∑–∏—Ç—å PDF —Ñ–∞–π–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–Ω–∏–≥–∞ SystemA)
   - **–í–∞—Ä–∏–∞–Ω—Ç –í:** –£–∫–∞–∑–∞—Ç—å Cloud Storage bucket —Å —Ñ–∞–π–ª–∞–º–∏

4. **–î–æ–∂–¥–∞—Ç—å—Å—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏:**
   - –û–±—ã—á–Ω–æ –∑–∞–Ω–∏–º–∞–µ—Ç 5-15 –º–∏–Ω—É—Ç
   - –°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–∏—Ç—Å—è –Ω–∞ "Ready"

5. **–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å Data Store ID:**
   - –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è, –≤ URL –±—É–¥–µ—Ç ID
   - –ù–∞–ø—Ä–∏–º–µ—Ä: `https://console.cloud.google.com/gen-app-builder/data-stores/1234567890?project=...`
   - Data Store ID = `1234567890`

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è Data Store, –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ —á–∞—Ç:

```typescript
{
  message: "–ß—Ç–æ —Ç–∞–∫–æ–µ VWAP?",
  useRAG: true,
  ragDataStoreId: "YOUR_DATA_STORE_ID"
}
```

---

## üìä –ü–†–û–í–ï–†–ö–ê –£–°–ü–ï–•–ê

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è Data Store –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

- ‚úÖ RAG –∑–∞–ø—Ä–æ—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç (–≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –æ—Ç–≤–µ—Ç—ã)
- ‚úÖ –í –ª–æ–≥–∞—Ö –Ω–µ—Ç –æ—à–∏–±–æ–∫
- ‚úÖ –í –∫–æ–Ω—Å–æ–ª–∏ –±–∏–ª–ª–∏–Ω–≥–∞ –≤–∏–¥–Ω—ã —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ `discoveryengine.googleapis.com`
- ‚úÖ –ö—Ä–µ–¥–∏—Ç "GenAI App Builder" —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è (‡∏ø32,310.50 —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è)

---

## üîó –ü–û–õ–ï–ó–ù–´–ï –°–°–´–õ–ö–ò

- **–°–æ–∑–¥–∞—Ç—å Data Store:** https://console.cloud.google.com/gen-app-builder/data-stores/create?project=gen-lang-client-0102901194
- **–°–ø–∏—Å–æ–∫ Data Stores:** https://console.cloud.google.com/gen-app-builder/data-stores?project=gen-lang-client-0102901194
- **–ë–∏–ª–ª–∏–Ω–≥:** https://console.cloud.google.com/billing/01DB30-E9BEE6-19F55A/reports?project=gen-lang-client-0102901194

---

## ‚úÖ –ò–¢–û–ì

**–ì–æ—Ç–æ–≤–æ:**
- ‚úÖ –ü—Ä–∞–≤–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ API –≤–∫–ª—é—á–µ–Ω
- ‚úÖ –ö–æ–¥ –≥–æ—Ç–æ–≤

**–û—Å—Ç–∞–ª–æ—Å—å:**
- ‚è≥ –°–æ–∑–¥–∞—Ç—å Data Store (5-10 –º–∏–Ω—É—Ç –≤—Ä—É—á–Ω—É—é)
- ‚è≥ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å RAG
- ‚è≥ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–ø–∏—Å–∞–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–æ–≤
